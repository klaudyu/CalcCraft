/* For column headers */
th::before {
    content: attr(data-col-label);
    position: absolute;
    font-size: smaller;
    color: gray;
    transform: translate(0px, -12px); 
}

/* For row headers for td */
tr td:first-child::before {
    content: attr(data-row-label);
    position: absolute;
    font-size: smaller;
    color: gray;
    #background-color:white;
    transform: translate(-16px, 0px);  
}


/**********formula cell************/
/*light theme*/
.markdown-rendered .formula-cell-borderenabled {
  #border:var(--CalcCraft-formula-borders);
  border:2px double;
}
.markdown-rendered .formula-cell-colorenabled {
  background-color: var(--CalcCraft_formula_background_color_light)!important ;  /* Light gray background */
  color:var(--CalcCraft_formula_font_color_light)!important;
  #border:2px double;
  #border:var(--CalcCraft-formula-borders);
  #font-style: italic;  /* Italic text */
}
/*dark theme*/
.theme-dark .markdown-rendered .formula-cell-colorenabled{
    background-color: var(--CalcCraft_formula_background_color_dark)!important;   
    color:var(--CalcCraft_formula_font_color_dark)!important;
}


/**********matrix  cell************/


.markdown-rendered .matrix-cell-colorenabled {
  background-color: var(--CalcCraft_formula_background_matrix_light)!important ;  /* Light gray background */
  color:var(--CalcCraft_formula_font_matrix_light)!important;
  #border:2px double;
  #font-style: italic;  /* Italic text */
}
.theme-dark .markdown-rendered .matrix-cell-colorenabled {
  background-color: var(--CalcCraft_formula_background_matrix_dark)!important ;  /* Light gray background */
  color:var(--CalcCraft_formula_font_matrix_dark)!important;
}

td.label-cell.column {
    border: none;
    color: gray;
    font-size: 80%;
    text-align: center;
    vertical-align: bottom;
    padding:.1em;
}

td.label-cell.row {
    border: none !important;
    color: gray;
    font-size: 80%;
    text-align: right;
    vertical-align: middle;
    padding:.2em;
}


/**************** error cells**************/
.markdown-rendered .error-cell-colorenabled{
    background-color: var(--CalcCraft_formula_background_error_light)!important ; 
    color:var(--CalcCraft_formula_font_error_light)!important
}
.theme-dark .markdown-rendered .error-cell-colorenabled{
    background-color: var(--CalcCraft_formula_background_error_dark)!important ;
    color:var(--CalcCraft_formula_font_error_dark)!important;
}


/*********** parents cells***************/
.markdown-rendered .cell-parents-highlight {
    background-color: var(--CalcCraft_formula_background_parents_light)!important;
    color:var(--CalcCraft_formula_font_parents_light)!important;
}
.theme-dark .markdown-rendered .formula-cell.error-cell.cell-parents-highlight,
.theme-dark  .markdown-rendered .cell-parents-highlight {
    background-color: var(--CalcCraft_formula_background_parents_dark)!important;
    color:var(--CalcCraft_formula_font_parents_dark)!important;
}


/* children cells*/
/* light theme*/
.markdown-rendered .formula-cell.error-cell.cell-children-highlight,
.markdown-rendered .cell-children-highlight {
    background-color: var(--CalcCraft_formula_background_children_light)!important;
    color:var(--CalcCraft_formula_font_children_light)!important;
}
.theme-dark .markdown-rendered .formula-cell.error-cell.cell-children-highlight,
.theme-dark  .markdown-rendered .cell-children-highlight {
    background-color: var(--CalcCraft_formula_background_children_dark)!important;
    color:var(--CalcCraft_formula_font_children_dark)!important;
}



/*active class*/
.markdown-rendered td.cell-active{
    text-decoration: underline;
}




/* Hide original text when showing computed value */
.cm-table-widget .table-cell-wrapper.calc-overlay-cell:not(:focus-within) {
    position: relative; 
    color: transparent;
}


/* Base overlay - inherits color from parent cell */
.cm-table-widget .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    content: attr(data-calc-display);
    position: absolute; 
    inset: 0;
    display: flex; 
    align-items: center; 
    white-space: pre;
    color: inherit; /* ‚Üê Changed from var(--text-normal) to inherit */
    pointer-events: none;
    padding: 0 4px;
}

/* Formula cell overlays - inherit formula colors */
.cm-table-widget .formula-cell-colorenabled .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    color: var(--CalcCraft_formula_font_color_light);
}

.theme-dark .cm-table-widget .formula-cell-colorenabled .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    color: var(--CalcCraft_formula_font_color_dark);
}

/* Matrix cell overlays */
.cm-table-widget .matrix-cell-colorenabled .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    color: var(--CalcCraft_formula_font_matrix_light);
}

.theme-dark .cm-table-widget .matrix-cell-colorenabled .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    color: var(--CalcCraft_formula_font_matrix_dark);
}

/* Error cell overlays */
.cm-table-widget .error-cell-colorenabled .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    color: var(--CalcCraft_formula_font_error_light);
}

.theme-dark .cm-table-widget .error-cell-colorenabled .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    color: var(--CalcCraft_formula_font_error_dark);
}

/* Parent highlight overlays */
.cm-table-widget .cell-parents-highlight .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    color: var(--CalcCraft_formula_font_parents_light);
}

.theme-dark .cm-table-widget .cell-parents-highlight .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    color: var(--CalcCraft_formula_font_parents_dark);
}

/* Children highlight overlays */
.cm-table-widget .cell-children-highlight .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    color: var(--CalcCraft_formula_font_children_light);
}

.theme-dark .cm-table-widget .cell-children-highlight .table-cell-wrapper.calc-overlay-cell:not(:focus-within)::after {
    color: var(--CalcCraft_formula_font_children_dark);
}

/* Make table cells position relative for absolute positioning of labels */
table th,
table td {
    position: relative;
}

/* Add padding to table to make room for labels */
table {
    margin-left: 25px;
    margin-top: 20px;
}

/* Column labels - display above th/td elements */
th[data-col-letter]::before,
td[data-col-letter]::before {
    content: attr(data-col-letter);
    position: absolute;
    top: -18px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.75em;
    color: var(--text-muted);
    font-weight: normal;
    pointer-events: none;
    white-space: nowrap;
    z-index: 1;
}

/* Row labels - display to the left of first cell in each row */
tr th:first-child[data-row-number]::after,
tr td:first-child[data-row-number]::after {
    content: attr(data-row-number);
    position: absolute;
    left: -25px;
    top: 50%;
    #transform: translateY(-50%);
    font-size: 0.75em;
    color: var(--text-muted);
    font-weight: normal;
    pointer-events: none;
    white-space: nowrap;
}


